{"version":3,"sources":["../../server/routes/events.js"],"names":["eventsRouter","express","Router","post","validateEventInput","req","res","body","then","timestamp","catch","e","code","get","result","status","send","message","events"],"mappings":";;;;;;AAAA;;;;AACA;;AAGA;;AAEA;;;;;;AAGA,IAAMA,eAAeC,kBAAQC,MAAR,EAArB;;AAGAF,aAAaG,IAAb,CAAkB,GAAlB,EAAuBC,8BAAvB,EAA2C,UAACC,GAAD,EAAMC,GAAN,EAAc;AACvD;;AAEA,4BAAYD,IAAIE,IAAhB,EAAsBC,IAAtB,CAA2B,YAAM;AAC/B,6BAAaF,GAAb,EAAkB,GAAlB,eAAiCD,IAAIE,IAAJ,CAASE,SAA1C;AACD,GAFD,EAEGC,KAFH,CAES,UAACC,CAAD,EAAO;AACd,QAAIA,EAAEC,IAAF,KAAW,OAAf,EAAwB;AACtB,+BAAaN,GAAb,EAAkB,GAAlB,EAAuB,IAAvB,EAA6B,0CAA7B;AACA;AACD;AACD,6BAAaA,GAAb,EAAkB,GAAlB,EAAuB,IAAvB,EAA6B,uBAA7B;AACD,GARD;AASD,CAZD;;AAeAN,aAAaa,GAAb,CAAiB,GAAjB,EAAsB,UAACR,GAAD,EAAMC,GAAN,EAAc;AAClC;AACA,4BAAYE,IAAZ,CAAiB,UAACM,MAAD,EAAY;AAC3BR,QAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,cAAQ,GADW;AAEnBE,eAAS,6BAFU;AAGnBC,cAAQJ;AAHW,KAArB;AAKD,GAND,EAMGJ,KANH,CAMS,YAAM;AACb;AACA,6BAAaJ,GAAb,EAAkB,GAAlB,EAAuB,IAAvB,EAA6B,uBAA7B;AACD,GATD;AAUD,CAZD;;kBAceN,Y","file":"events.js","sourcesContent":["import express from 'express';\nimport {\n  validateEventInput,\n} from '../helpers/validators';\nimport { createEvent, getEvents } from '../crud/db-query';\n\nimport sendResponse from '../helpers/responses';\n\n\nconst eventsRouter = express.Router();\n\n\neventsRouter.post('/', validateEventInput, (req, res) => {\n  // query database\n\n  createEvent(req.body).then(() => {\n    sendResponse(res, 201, `event '${req.body.timestamp}' was successfully uploaded`);\n  }).catch((e) => {\n    if (e.code === '23505') {\n      sendResponse(res, 409, null, 'Event with same timestamp already exists');\n      return;\n    }\n    sendResponse(res, 500, null, 'Internal server error');\n  });\n});\n\n\neventsRouter.get('/', (req, res) => {\n  // query database\n  getEvents().then((result) => {\n    res.status(200).send({\n      status: 200,\n      message: 'successfully fetched events',\n      events: result,\n    });\n  }).catch(() => {\n    // console.log(e);\n    sendResponse(res, 500, null, 'Internal server error');\n  });\n});\n\nexport default eventsRouter;\n"]}